# CursorFlow ê°œì„  ë¡œë“œë§µ

ì´ ë¬¸ì„œëŠ” í˜„ì¬ ì•„í‚¤í…ì²˜ ë¶„ì„ì„ ë°”íƒ•ìœ¼ë¡œ ì‹ë³„ëœ ê°œì„ ì‚¬í•­ë“¤ì„ ì •ë¦¬í•©ë‹ˆë‹¤.

---

## 1. í˜„ì¬ ì•„í‚¤í…ì²˜ ìš”ì•½

### 1.1 ìµœê·¼ ë¦¬íŒ©í† ë§ (ì™„ë£Œ)

| ë³€ê²½ | ì„¤ëª… | íš¨ê³¼ |
|------|------|------|
| `AgentSupervisor` ë„ì… | ì—ì´ì „íŠ¸ í”„ë¡¬í”„íŠ¸ ì „ì†¡/ì‹¤íŒ¨ ë¶„ì„ í†µí•© | ì±…ì„ ë¶„ë¦¬, ì´ë²¤íŠ¸ ê¸°ë°˜ ëª¨ë‹ˆí„°ë§ |
| `GitPipelineCoordinator` ë„ì… | Git worktree/ë¨¸ì§€ ë¡œì§ ë¶„ë¦¬ | ì¬ì‚¬ìš©ì„±, í…ŒìŠ¤íŠ¸ ìš©ì´ì„± |
| `failure-policy.ts` ê°œì„  | ì‹¤íŒ¨ ìœ í˜•/ë³µêµ¬ ì•¡ì…˜ ì¤‘ì•™í™” | ì¼ê´€ëœ ì˜¤ë¥˜ ì²˜ë¦¬ |
| ëª¨ë‹ˆí„°ë§ UX v2.0 | íƒ­ ê¸°ë°˜ ë„¤ë¹„ê²Œì´ì…˜ | ì‚¬ìš©ì„± í–¥ìƒ |
| ë¡œê¹… ì‹œìŠ¤í…œ í†µí•© | raw-log.ts, buffer.ts ê°œì„  | ë¡œê·¸ ê²½ë¡œ ì¼ê´€ì„± |

### 1.2 í˜„ì¬ êµ¬ì¡°ì˜ ê°•ì 

- âœ… Git Worktree ê¸°ë°˜ ê²©ë¦¬ë¡œ ì•ˆì „í•œ ë³‘ë ¬ ì‹¤í–‰
- âœ… ë‹¤ë‹¨ê³„ Stall ê°ì§€ ë° ë³µêµ¬
- âœ… Circuit Breaker íŒ¨í„´ìœ¼ë¡œ ì—°ì‡„ ì‹¤íŒ¨ ë°©ì§€
- âœ… ì²´í¬í¬ì¸íŠ¸ ê¸°ë°˜ ì¬ê°œ ì§€ì›
- âœ… ì´ë²¤íŠ¸ ê¸°ë°˜ ëª¨ë“ˆ ê°„ í†µì‹ 

---

## 2. ë‹¨ê¸° ê°œì„ ì‚¬í•­ (1-2ì£¼)

### 2.1 í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ê°•í™”

**í˜„í™©**: í•µì‹¬ ëª¨ë“ˆì— ëŒ€í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë¶€ì¡±

**ì œì•ˆ**:
```
tests/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ agent-supervisor.test.ts     # ì‹ ê·œ
â”‚   â”œâ”€â”€ git-pipeline-coordinator.test.ts  # ì‹ ê·œ
â”‚   â”œâ”€â”€ failure-policy.test.ts       # í™•ì¥
â”‚   â””â”€â”€ stall-detection.test.ts      # í™•ì¥
â”œâ”€â”€ services/
â”‚   â””â”€â”€ logging/
â”‚       â””â”€â”€ buffer.test.ts           # ì‹ ê·œ
â””â”€â”€ integration/
    â””â”€â”€ pipeline-flow.test.ts        # ì‹ ê·œ
```

**ìš°ì„ ìˆœìœ„ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤**:
1. `AgentSupervisor.sendTaskPrompt()` ì‹¤íŒ¨ ë¶„ì„ ë¡œì§
2. `GitPipelineCoordinator.mergeDependencyBranches()` ì¶©ëŒ ì²˜ë¦¬
3. `analyzeFailure()` ê° ì‹¤íŒ¨ ìœ í˜•ë³„ ë³µêµ¬ ì•¡ì…˜
4. Stall ê°ì§€ â†’ ë³µêµ¬ íë¦„ í†µí•© í…ŒìŠ¤íŠ¸

### 2.2 ì—ëŸ¬ ë©”ì‹œì§€ ê°œì„ 

**í˜„í™©**: ì¼ë¶€ ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ëª¨í˜¸í•˜ê±°ë‚˜ ê¸°ìˆ ì ì„

**ì œì•ˆ**:
- ì‚¬ìš©ì ì¹œí™”ì  ì˜¤ë¥˜ ë©”ì‹œì§€ + í•´ê²° ê°€ì´ë“œ ì¶”ê°€
- `cursorflow doctor --diagnose <error-code>` ëª…ë ¹ì–´ ì¶”ê°€

```typescript
// ê°œì„  ì „
throw new Error('Merge conflict');

// ê°œì„  í›„
throw new CursorFlowError('MERGE_CONFLICT', {
  message: 'Git ë¨¸ì§€ ì¶©ëŒì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',
  files: conflictingFiles,
  guide: 'ì¶©ëŒ íŒŒì¼ì„ ìˆ˜ë™ìœ¼ë¡œ í•´ê²°í•˜ê±°ë‚˜, cursorflow resume --force ë¡œ ì¬ì‹œë„í•˜ì„¸ìš”.',
  docs: 'https://docs.cursorflow.io/troubleshooting/merge-conflict'
});
```

### 2.3 ë¡œê¹… ê°œì„ 

**í˜„í™©**: ë””ë²„ê·¸ ì‹œ í•„ìš”í•œ ì •ë³´ ë¶€ì¡±

**ì œì•ˆ**:
- êµ¬ì¡°í™”ëœ JSON ë¡œê·¸ ì˜µì…˜ ì¶”ê°€
- ë¡œê·¸ ë ˆë²¨ë³„ í•„í„°ë§ ê°•í™”
- íŠ¸ë ˆì´ìŠ¤ IDë¡œ Lane/Task ì¶”ì 

```typescript
// íŠ¸ë ˆì´ìŠ¤ ì»¨í…ìŠ¤íŠ¸ ì˜ˆì‹œ
interface LogContext {
  runId: string;
  laneId: string;
  taskId?: string;
  traceId: string;
}
```

---

## 3. ì¤‘ê¸° ê°œì„ ì‚¬í•­ (1-2ê°œì›”)

### 3.1 Orchestrator ë¦¬íŒ©í† ë§

**í˜„í™©**: `orchestrator.ts`ê°€ 1100+ ì¤„ë¡œ ë¹„ëŒ€í•¨

**ì œì•ˆ ë¶„ë¦¬ êµ¬ì¡°**:
```
src/core/orchestrator/
â”œâ”€â”€ index.ts              # ì§„ì…ì 
â”œâ”€â”€ lane-manager.ts       # Lane ìƒëª…ì£¼ê¸° ê´€ë¦¬
â”œâ”€â”€ dependency-resolver.ts # ì˜ì¡´ì„± í•´ê²° ë¡œì§
â”œâ”€â”€ process-spawner.ts    # í”„ë¡œì„¸ìŠ¤ ìƒì„±/ê´€ë¦¬
â”œâ”€â”€ event-handler.ts      # ì´ë²¤íŠ¸ ì²˜ë¦¬
â””â”€â”€ cleanup.ts            # ë¦¬ì†ŒìŠ¤ ì •ë¦¬
```

**ì±…ì„ ë¶„ë¦¬**:
| ëª¨ë“ˆ | ì±…ì„ |
|------|------|
| `LaneManager` | Lane ìƒíƒœ ê´€ë¦¬, ì‹œì‘/ì¤‘ì§€/ì¬ì‹œì‘ |
| `DependencyResolver` | ì˜ì¡´ì„± ê·¸ë˜í”„ êµ¬ì¶•, êµì°©ìƒíƒœ ê°ì§€ |
| `ProcessSpawner` | ìì‹ í”„ë¡œì„¸ìŠ¤ ìƒì„±, IPC í†µì‹  |
| `EventHandler` | ì´ë²¤íŠ¸ êµ¬ë…/ë°œí–‰ ì¤‘ì•™í™” |
| `CleanupService` | Worktree/ë¸Œëœì¹˜/í”„ë¡œì„¸ìŠ¤ ì •ë¦¬ |

### 3.2 í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œ

**í˜„í™©**: í™•ì¥ì„± ì œí•œì 

**ì œì•ˆ**:
```typescript
interface CursorFlowPlugin {
  name: string;
  version: string;
  
  // ë¼ì´í”„ì‚¬ì´í´ í›…
  onRunStart?(context: RunContext): Promise<void>;
  onLaneStart?(context: LaneContext): Promise<void>;
  onTaskStart?(context: TaskContext): Promise<void>;
  onTaskComplete?(context: TaskContext, result: TaskResult): Promise<void>;
  onLaneComplete?(context: LaneContext, result: LaneResult): Promise<void>;
  onRunComplete?(context: RunContext, results: RunResult): Promise<void>;
  
  // ì‹¤íŒ¨ í›…
  onFailure?(context: FailureContext, analysis: FailureAnalysis): Promise<RecoveryAction | null>;
  
  // ì»¤ìŠ¤í…€ ì»¤ë§¨ë“œ
  commands?: Command[];
}
```

**í™œìš© ì˜ˆì‹œ**:
- Slack/Discord ì•Œë¦¼ í”ŒëŸ¬ê·¸ì¸
- ì»¤ìŠ¤í…€ ë¦¬ë·° ì •ì±… í”ŒëŸ¬ê·¸ì¸
- ë©”íŠ¸ë¦­ ìˆ˜ì§‘ í”ŒëŸ¬ê·¸ì¸ (Prometheus/DataDog)

### 3.3 Web Dashboard

**í˜„í™©**: CLI ê¸°ë°˜ ëª¨ë‹ˆí„°ë§ë§Œ ì§€ì›

**ì œì•ˆ**:
- ì‹¤ì‹œê°„ ì›¹ ëŒ€ì‹œë³´ë“œ (React + WebSocket)
- ë©€í‹° í”„ë¡œì íŠ¸ í†µí•© ë·°
- íˆìŠ¤í† ë¦¬ ë° í†µê³„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CursorFlow Dashboard                    [Live]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Active Runs: 3    Total Lanes: 12    Success: 8  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Run: cursorflow/run-abc123                  â”‚  â”‚
â”‚  â”‚ â”œâ”€ Lane: api-setup    [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] 80%     â”‚  â”‚
â”‚  â”‚ â”œâ”€ Lane: frontend     [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 60%     â”‚  â”‚
â”‚  â”‚ â””â”€ Lane: tests        [Waiting]             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. ì¥ê¸° ê°œì„ ì‚¬í•­ (3ê°œì›”+)

### 4.1 ë¶„ì‚° ì‹¤í–‰ ì§€ì›

**í˜„í™©**: ë‹¨ì¼ ë¨¸ì‹  ì‹¤í–‰ë§Œ ì§€ì›

**ì œì•ˆ**:
- Remote Worker ì§€ì› (SSH/Docker)
- ì‘ì—… í ì‹œìŠ¤í…œ (Redis/RabbitMQ)
- Laneê°„ ë¦¬ì†ŒìŠ¤ ê³µìœ  ìµœì í™”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Machine A  â”‚     â”‚  Machine B  â”‚     â”‚  Machine C  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Lane1 â”‚  â”‚     â”‚  â”‚ Lane2 â”‚  â”‚     â”‚  â”‚ Lane3 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                    â”‚ Orchestrator â”‚
                    â”‚  (Central)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 AI ëª¨ë¸ ë‹¤ì–‘í™”

**í˜„í™©**: Cursor Agentì— ì¢…ì†

**ì œì•ˆ**:
- OpenAI API ì§ì ‘ ì§€ì›
- Anthropic Claude ì§€ì›
- ë¡œì»¬ LLM (Ollama) ì§€ì›
- ëª¨ë¸ë³„ í”„ë¡¬í”„íŠ¸ ìµœì í™”

```typescript
interface AIProvider {
  name: string;
  sendPrompt(prompt: string, options: PromptOptions): Promise<ProviderResponse>;
  streamResponse?(prompt: string, options: PromptOptions): AsyncIterable<string>;
}

// ì„¤ì • ì˜ˆì‹œ
{
  "provider": "openai",
  "model": "gpt-4-turbo",
  "fallback": {
    "provider": "cursor-agent",
    "model": "default"
  }
}
```

### 4.3 ì§€ëŠ¥í˜• ì‹¤íŒ¨ ì˜ˆì¸¡

**í˜„í™©**: ì‚¬í›„ ì‹¤íŒ¨ ëŒ€ì‘

**ì œì•ˆ**:
- ì‹¤íŒ¨ íŒ¨í„´ í•™ìŠµ (ML ê¸°ë°˜)
- ì„ ì œì  ë¦¬ì†ŒìŠ¤ ì¡°ì •
- ìœ ì‚¬ ì‹¤íŒ¨ ìë™ ë¶„ë¥˜

```typescript
interface FailurePrediction {
  probability: number;      // 0-1
  predictedType: FailureType;
  suggestedPrevention: string[];
  confidence: number;
}

// í™œìš© ì˜ˆì‹œ
if (prediction.probability > 0.7) {
  logger.warn(`High failure probability detected: ${prediction.predictedType}`);
  await applyPreventiveMeasures(prediction.suggestedPrevention);
}
```

---

## 5. ê¸°ìˆ  ë¶€ì±„ í•´ê²°

### 5.1 ì¦‰ì‹œ í•´ê²° í•„ìš”

| í•­ëª© | ìœ„ì¹˜ | í•´ê²° ë°©ì•ˆ |
|------|------|----------|
| ~~analyzeStall deprecated~~ | `failure-policy.ts` | âœ… StallDetectionServiceë¡œ í†µí•© ì™„ë£Œ |
| í•˜ë“œì½”ë”©ëœ íƒ€ì„ì•„ì›ƒ | ì—¬ëŸ¬ ê³³ | ì„¤ì • íŒŒì¼ë¡œ ì¶”ì¶œ |
| any íƒ€ì… ì‚¬ìš© | ì—¬ëŸ¬ ê³³ | êµ¬ì²´ì  íƒ€ì…ìœ¼ë¡œ êµì²´ |

### 5.2 ì ì§„ì  ê°œì„ 

| í•­ëª© | í˜„í™© | ëª©í‘œ |
|------|------|------|
| ESLint ê²½ê³  | ~50ê±´ | 0ê±´ |
| í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ | ~40% | 80%+ |
| ë¬¸ì„œí™” | ë¶€ë¶„ì  | JSDoc 100% |

---

## 6. ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ

### 6.1 v0.1.x â†’ v0.2.0 (ì˜ˆì •)

**Breaking Changes**:
- `orchestrator.ts` ë¶„ë¦¬ë¡œ ì¸í•œ import ê²½ë¡œ ë³€ê²½
- ì„¤ì • íŒŒì¼ ìŠ¤í‚¤ë§ˆ ë³€ê²½

**ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸**:
```bash
npx cursorflow migrate --from 0.1 --to 0.2
```

---

## 7. ìš°ì„ ìˆœìœ„ ë§¤íŠ¸ë¦­ìŠ¤

```
           ë†’ì€ ê°€ì¹˜
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  í…ŒìŠ¤íŠ¸  â”‚  Orch   â”‚
    â”‚  ì»¤ë²„ë¦¬ì§€â”‚  ë¶„ë¦¬   â”‚
    â”‚         â”‚         â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚  ì—ëŸ¬   â”‚  í”ŒëŸ¬ê·¸ì¸â”‚
    â”‚  ë©”ì‹œì§€  â”‚  ì‹œìŠ¤í…œ  â”‚
ë‚®ì€ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ ë†’ì€
ë…¸ë ¥ â”‚  ë¡œê¹…   â”‚   Web   â”‚ ë…¸ë ¥
    â”‚  ê°œì„    â”‚Dashboard â”‚
    â”‚         â”‚         â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚  íƒ€ì…   â”‚  ë¶„ì‚°   â”‚
    â”‚  ê°œì„    â”‚  ì‹¤í–‰   â”‚
    â”‚         â”‚         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
           ë‚®ì€ ê°€ì¹˜
```

**ê¶Œì¥ ì‹¤í–‰ ìˆœì„œ**:
1. ğŸ”´ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ (ë†’ì€ ê°€ì¹˜, ë‚®ì€ ë…¸ë ¥)
2. ğŸŸ  ì—ëŸ¬ ë©”ì‹œì§€ ê°œì„  (ë†’ì€ ê°€ì¹˜, ë‚®ì€ ë…¸ë ¥)
3. ğŸŸ¡ Orchestrator ë¶„ë¦¬ (ë†’ì€ ê°€ì¹˜, ë†’ì€ ë…¸ë ¥)
4. ğŸŸ¢ ë¡œê¹… ê°œì„  (ì¤‘ê°„ ê°€ì¹˜, ë‚®ì€ ë…¸ë ¥)
5. ğŸ”µ í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œ (ì¤‘ê°„ ê°€ì¹˜, ì¤‘ê°„ ë…¸ë ¥)

---

## 8. ì°¸ê³  ìë£Œ

- [MODULE_GUIDE.md](./MODULE_GUIDE.md) - ëª¨ë“ˆë³„ ì—­í•  ì •ì˜
- [CHANGELOG.md](./CHANGELOG.md) - ë²„ì „ë³„ ë³€ê²½ ì´ë ¥

